import base64


encoded_code = """
aW1wb3J0IHJhbmRvbQppbXBvcnQgc3RyaW5nCgpkZWYgZ2VuZXJhdGVfcGFzc3dvcmQobGVuZ3RoPTEyKToKICAgIGNoYXJhY3RlcnMgPSBzdHJpbmcuYXNjaWlfbGV0dGVycyArIHN0cmluZy5kaWdpdHMgKyBzdHJpbmcucHVuY3R1YXRpb24KICAgIHJldHVybiAnJy5qb2luKHJhbmRvbS5jaG9pY2UoY2hhcmFjdGVycykgZm9yIF8gaW4gcmFuZ2UobGVuZ3RoKSkKCmRlZiBkaXNwbGF5X3dlbGNvbWVfbWVzc2FnZSgpOgogICAgcHJpbnQoIlxuIiArICI9IiAqIDYwKQogICAgcHJpbnQoInx8IiArICIgIiAqIDU2ICsgInx8IikKICAgIHByaW50KCJ8fCIgKyAiICIgKiAxOCArICLwn4+IIFBBU1NXT1JEIEdFTkVSQVRPUiDwn4+IIiArICIgIiAqIDE4ICsgInx8IikKICAgIHByaW50KCJ8fCIgKyAiICIgKiA1NiArICJ8fCIpCiAgICBwcmludCgiPSIgKiA2MCkKICAgIHByaW50KCJcbldlbGNvbWUgdG8gdGhlIFVsdGltYXRlIFBhc3N3b3JkIEdlbmVyYXRvciEiKQogICAgcHJpbnQoIkNyZWF0ZSBzdHJvbmcsIHNlY3VyZSwgYW5kIHJhbmRvbSBwYXNzd29yZHMgaW4gc2Vjb25kcy5cbiIpCgpkZWYgZ2V0X3VzZXJfaW5wdXQocHJvbXB0LCBtaW5fdmFsdWUsIG1heF92YWx1ZSk6CiAgICB3aGlsZSBUcnVlOgogICAgICAgIHRyeToKICAgICAgICAgICAgdXNlcl9pbnB1dCA9IGludChpbnB1dChwcm9tcHQpKQogICAgICAgICAgICBpZiBtaW5fdmFsdWUgPD0gdXNlcl9pbnB1dCA8PSBtYXhfdmFsdWU6CiAgICAgICAgICAgICAgICByZXR1cm4gdXNlcl9pbnB1dAogICAgICAgICAgICBlbHNlOgogICAgICAgICAgICAgICAgcHJpbnQoZiJQbGVhc2UgZW50ZXIgYSBudW1iZXIgYmV0d2VlbiB7bWluX3ZhbHVlfSBhbmQge21heF92YWx1ZX0uIikKICAgICAgICBleGNlcHQgVmFsdWVFcnJvcjoKICAgICAgICAgICAgcHJpbnQoIkludmFsaWQgaW5wdXQhIFBsZWFzZSBlbnRlciBhIHZhbGlkIG51bWJlci4iKQoKZGVmIG1haW4oKToKICAgIGRpc3BsYXlfd2VsY29tZV9tZXNzYWdlKCkKCiAgICBudW1fcGFzc3dvcmRzID0gZ2V0X3VzZXJfaW5wdXQoCiAgICAgICAgIkhvdyBtYW55IHBhc3N3b3JkcyB3b3VsZCB5b3UgbGlrZSB0byBnZW5lcmF0ZT8gKE1pbiAxLCBNYXggNTApOiAiLAogICAgICAgIG1pbl92YWx1ZT0xLAogICAgICAgIG1heF92YWx1ZT01MAogICAgKQoKICAgIHBhc3N3b3JkX2xlbmd0aCA9IGdldF91c2VyX2lucHV0KAogICAgICAgICJFbnRlciB0aGUgbGVuZ3RoIG9mIGVhY2ggcGFzc3dvcmQgKE1pbiA4LCBNYXggNTApOiAiLAogICAgICAgIG1pbl92YWx1ZT04LAogICAgICAgIG1heF92YWx1ZT01MAogICAgKQoKICAgIHByaW50KCJcbiIgKyAiLSIgKiA2MCkKICAgIHByaW50KCLwn5iIIEdlbmVyYXRpbmcgeW91ciBwYXNzd29yZHMuLi4g8J+YiFxuIikKICAgIGZvciBpIGluIHJhbmdlKG51bV9wYXNzd29yZHMpOgogICAgICAgIHBhc3N3b3JkID0gZ2VuZXJhdGVfcGFzc3dvcmQocGFzc3dvcmRfbGVuZ3RoKQogICAgICAgIHByaW50KGYi4p2kIFBhc3N3b3JkIHtpICsgMX06IHtwYXNzd29yZH0iKQogICAgcHJpbnQoIlxuIiArICItIiAqIDYwKQogICAgcHJpbnQoIlRoYW5rIHlvdSBmb3IgdXNpbmcgdGhlIFVsdGltYXRlIFBhc3N3b3JkIEdlbmVyYXRvciEgU3RheSBzZWN1cmUhIPCflKZcbiIpCiAgICBwcmludCgi4oiaIDIwMjUgQ2FzcGVyLiBBbGwgcmlnaHRzIHJlc2VydmVkLlxuIikKCmlmIF9fbmFtZV9fID09ICJfX21haW5fXyI6CiAgICBtYWluKCk=
"""


exec(base64.b64decode(encoded_code).decode('utf-8'))
